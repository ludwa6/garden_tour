<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QR Admin</title>

  <!-- Use relative paths (no leading slash) so it works under / and /garden_tour/ -->
  <link rel="stylesheet" href="style.css?v=2">
</head>
<body class="qr-admin-page">
  <div class="appbar">
    <h1>QR Admin</h1>
    <a href="index.html" class="back-btn">‚Üê Back to main</a>
  </div>

  <main id="qr-admin-content">
    <!-- Controls -->
    <div class="controls">
      <label for="observationSelect">Select Observation:</label>
      <select id="observationSelect">
        <option value="">Loading...</option>
      </select>
    </div>

    <!-- QR code preview -->
    <div id="qr-preview">
      <h3>Custom QR Code:</h3>
      <canvas id="qrCanvas"></canvas>
    </div>
    
    <!-- Observation preview -->
    <div id="observationPreview" class="preview"></div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <!-- Again: relative path, no leading slash -->
  <script src="qr_admin.js"></script>

  <footer id="site-footer"></footer>

  <script>
    // Compute repo base regardless of localhost vs GitHub Pages
    // e.g. "/" for localhost, "/garden_tour/" on GH Pages
    (function () {
      const parts = window.location.pathname.split("/").filter(Boolean);
      const repoBase = window.location.hostname.includes("github.io") && parts.length
        ? `/${parts[0]}/`
        : "/";

      // Load shared footer
      const footerPath = new URL("footer.html", window.location.origin + repoBase).href;
      fetch(footerPath)
        .then(res => res.text())
        .then(html => {
          document.getElementById("site-footer").innerHTML = html;
          // Rewrite nav links so they work even from subfolders
          document.querySelectorAll("#site-footer .nav-link").forEach(link => {
            const target = link.getAttribute("data-target");
            if (target) {
              link.href = new URL(target, window.location.origin + repoBase).href;
            }
          });
        })
        .catch(err => console.error("Failed to load footer:", err));
    })();
  </script>
</body>
</html>
